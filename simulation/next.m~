function [P,Q] = next(S,T,P)

% assumes zero knowledge of local drift direction and speed.

% average debris drift speed
ds = dV*dt; %m
% standard deviation
sigma_s = .5*ds; %m
% grid size
dx = mean(diff(unique(S.xnodes))); %m
% nextcell distance (approximate by diam)
dd = sqrt(2)*(dx/2);

% range of motion in cells (1sigma)
Nmove = ceil((ds+sigma_s)/dd);
Pmove = zeros(Nmove,1);
Pmove(1) = normcdf(dd,ds,sigma_s);
for i=2:Nmove-1
    Pmove(i) = normcdf(dd*i,ds,sigma_s) - Pmove(i-1);
end
Pmove(end) = 1 - sum(Pmove(1:end-1));
Pdiff = 8*(1:Nmove)-8;
Pdiff(1) = 1;
Pmove = Pmove(:)./Pdiff(:);

Ppadded = zeros(S.dim+Nmove-1);
Ppadded(Nmove:(end-Nmove+1),Nmove:(end-Nmove+1)) = P;

Ppadded(:) = T*Ppadded(:);

P = Ppadded(Nmove:(end-Nmove+1),Nmove:(end-Nmove+1));
% renormalization
P = P./sum(P(:));
Q = sum(sum(Ppadded([1:Nmove-1 (end-Nmove+1):end],:))) + ...
    sum(sum(Ppadded(:,[1:Nmove-1 (end-Nmove+1):end])));

end